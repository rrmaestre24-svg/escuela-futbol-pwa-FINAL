<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MY CLUB - Super Admin - Super Admin - MY CLUB</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Panel de administraci√≥n de licencias MY CLUB">
    <meta name="theme-color" content="#0d9488">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Super Admin">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Iconos para iOS -->
    <link rel="apple-touch-icon" href="./icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./icons/icon-192x192.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="./icons/icon-96x96.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class'
        }
    </script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- jsPDF para generar facturas PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        /* Animaciones */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
        
        /* Scrollbar personalizado */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        
        /* Tabla responsive */
        .table-container { overflow-x: auto; }
        
        /* Cards hover */
        .stat-card:hover { transform: translateY(-2px); box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
        
        /* PWA Install Button */
        .install-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* Gr√°fico de barras simple */
        .bar-chart {
            display: flex;
            align-items: flex-end;
            gap: 4px;
            height: 60px;
        }
        .bar {
            width: 20px;
            background: linear-gradient(to top, #0d9488, #14b8a6);
            border-radius: 4px 4px 0 0;
            transition: height 0.3s ease;
        }
    </style>
</head>
<body class="dark bg-gray-900 min-h-screen">
    
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl p-8 w-full max-w-md animate-fade-in">
            <div class="text-center mb-8">
                <div class="text-6xl mb-4">üõ°Ô∏è</div>
                <h1 class="text-2xl font-bold text-white">Panel Super Admin</h1>
                <p class="text-gray-400 text-sm mt-2">MY CLUB - Sistema de Licencias</p>
            </div>
            
            <form id="adminLoginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">
                        <i data-lucide="mail" class="w-4 h-4 inline mr-1"></i>
                        Email
                    </label>
                    <input type="email" id="adminEmail" required
                           class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500"
                           placeholder="admin@email.com">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">
                        <i data-lucide="lock" class="w-4 h-4 inline mr-1"></i>
                        Contrase√±a
                    </label>
                    <input type="password" id="adminPassword" required
                           class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500"
                           placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                
                <button type="submit" 
                        class="w-full bg-gradient-to-r from-teal-600 to-blue-600 hover:from-teal-700 hover:to-blue-700 text-white font-bold py-3 rounded-xl transition-all">
                    Ingresar
                </button>
            </form>
            
            <p class="text-center text-gray-500 text-xs mt-6">
                Acceso restringido a administradores
            </p>
        </div>
    </div>
    
    <!-- Panel Principal -->
    <div id="adminPanel" class="hidden">
        <!-- Header -->
        <header class="bg-gray-800 border-b border-gray-700 px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <span class="text-3xl">üõ°Ô∏è</span>
                    <div>
                        <h1 class="text-xl font-bold text-white">Panel Super Admin</h1>
                        <p class="text-sm text-gray-400">MY CLUB - Sistema de Licencias</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <span id="adminUserEmail" class="text-sm text-gray-400"></span>
                    <button onclick="adminLogout()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm flex items-center gap-2">
                        <i data-lucide="log-out" class="w-4 h-4"></i>
                        Salir
                    </button>
                </div>
            </div>
        </header>
        
        <!-- Contenido Principal -->
        <main class="p-6">
            <!-- Stats Cards - Fila 1: Escuelas -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-4">
                <!-- Total Escuelas -->
                <div class="stat-card bg-gradient-to-br from-teal-600 to-teal-700 rounded-2xl p-6 transition-all">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-teal-100 text-sm">Escuelas Activas</p>
                            <p id="statActiveSchools" class="text-4xl font-bold text-white mt-1">0</p>
                        </div>
                        <div class="bg-white bg-opacity-20 p-3 rounded-xl">
                            <i data-lucide="school" class="w-8 h-8 text-white"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Escuelas Inactivas -->
                <div class="stat-card bg-gradient-to-br from-red-600 to-red-700 rounded-2xl p-6 transition-all">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-red-100 text-sm">Escuelas Inactivas</p>
                            <p id="statInactiveSchools" class="text-4xl font-bold text-white mt-1">0</p>
                        </div>
                        <div class="bg-white bg-opacity-20 p-3 rounded-xl">
                            <i data-lucide="alert-circle" class="w-8 h-8 text-white"></i>
                        </div>
                    </div>
                </div>
                            
                <!-- Pr√≥ximos a Vencer -->
                <div class="stat-card bg-gradient-to-br from-yellow-600 to-orange-600 rounded-2xl p-6 transition-all">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-yellow-100 text-sm">Pr√≥ximos a Vencer (7 d√≠as)</p>
                            <p id="statExpiringSoon" class="text-4xl font-bold text-white mt-1">0</p>
                        </div>
                        <div class="bg-white bg-opacity-20 p-3 rounded-xl">
                            <i data-lucide="clock" class="w-8 h-8 text-white"></i>
                        </div>
                    </div>
                </div>
                <button onclick="showTab('suggestions')" class="relative flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-lg transition-colors">
                            üí° Sugerencias
                            <span id="suggestionBadge" class="hidden absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center animate-pulse"></span>
                            </button>
                
                <!-- C√≥digos Pendientes -->
                <div class="stat-card bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl p-6 transition-all">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100 text-sm">C√≥digos Sin Usar</p>
                            <p id="statPendingCodes" class="text-4xl font-bold text-white mt-1">0</p>
                        </div>
                        <div class="bg-white bg-opacity-20 p-3 rounded-xl">
                            <i data-lucide="ticket" class="w-8 h-8 text-white"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Stats Cards - Fila 2: Facturaci√≥n üí∞ -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Ingresos del Mes -->
                <div class="stat-card bg-gradient-to-br from-green-600 to-emerald-700 rounded-2xl p-6 transition-all">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100 text-sm">Ingresos del Mes</p>
                            <p id="statMonthlyIncome" class="text-3xl font-bold text-white mt-1">$0</p>
                        </div>
                        <div class="bg-white bg-opacity-20 p-3 rounded-xl">
                            <i data-lucide="trending-up" class="w-8 h-8 text-white"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Ingresos del A√±o -->
                <div class="stat-card bg-gradient-to-br from-emerald-600 to-green-700 rounded-2xl p-6 transition-all">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-emerald-100 text-sm">Ingresos del A√±o</p>
                            <p id="statYearlyIncome" class="text-3xl font-bold text-white mt-1">$0</p>
                        </div>
                        <div class="bg-white bg-opacity-20 p-3 rounded-xl">
                            <i data-lucide="dollar-sign" class="w-8 h-8 text-white"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Pagos Pendientes -->
                <div class="stat-card bg-gradient-to-br from-amber-600 to-yellow-700 rounded-2xl p-6 transition-all">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-amber-100 text-sm">Pagos Pendientes</p>
                            <p id="statPendingPayments" class="text-4xl font-bold text-white mt-1">0</p>
                        </div>
                        <div class="bg-white bg-opacity-20 p-3 rounded-xl">
                            <i data-lucide="receipt" class="w-8 h-8 text-white"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Total Facturas -->
                <div class="stat-card bg-gradient-to-br from-purple-600 to-violet-700 rounded-2xl p-6 transition-all">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100 text-sm">Total Facturas</p>
                            <p id="statTotalInvoices" class="text-4xl font-bold text-white mt-1">0</p>
                        </div>
                        <div class="bg-white bg-opacity-20 p-3 rounded-xl">
                            <i data-lucide="file-text" class="w-8 h-8 text-white"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Secci√≥n de Acciones R√°pidas -->
            <div class="bg-gray-800 rounded-2xl p-6 mb-8">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i data-lucide="zap" class="w-5 h-5 text-yellow-500"></i>
                    Acciones R√°pidas
                </h2>
                <div class="flex flex-wrap gap-4">
                    <button onclick="showGenerateCodeModal()" 
                            class="bg-teal-600 hover:bg-teal-700 text-white px-6 py-3 rounded-xl font-medium flex items-center gap-2 transition-all">
                        <i data-lucide="plus-circle" class="w-5 h-5"></i>
                        Generar C√≥digo
                    </button>
                    <button onclick="refreshData()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-medium flex items-center gap-2 transition-all">
                        <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                        Actualizar Datos
                    </button>
                    <button onclick="showCodesTab()" 
                            class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-xl font-medium flex items-center gap-2 transition-all">
                        <i data-lucide="list" class="w-5 h-5"></i>
                        Ver C√≥digos
                    </button>
                    <button onclick="showNewPaymentModal()" 
                            class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-medium flex items-center gap-2 transition-all">
                        <i data-lucide="credit-card" class="w-5 h-5"></i>
                        Registrar Pago
                    </button>
                </div>
            </div>
            
            <!-- Tabs -->
            <div class="flex flex-wrap gap-2 mb-6">
                <button onclick="showTab('schools')" id="tabSchools"
                        class="px-6 py-3 rounded-xl font-medium transition-all bg-teal-600 text-white">
                    üè´ Escuelas
                </button>
                <button onclick="showTab('codes')" id="tabCodes"
                        class="px-6 py-3 rounded-xl font-medium transition-all bg-gray-700 text-gray-300 hover:bg-gray-600">
                    üéüÔ∏è C√≥digos
                </button>
                <button onclick="showTab('alerts')" id="tabAlerts"
                        class="px-6 py-3 rounded-xl font-medium transition-all bg-gray-700 text-gray-300 hover:bg-gray-600">
                    ‚ö†Ô∏è Alertas
                </button>
                <button onclick="showTab('billing')" id="tabBilling"
                        class="px-6 py-3 rounded-xl font-medium transition-all bg-gray-700 text-gray-300 hover:bg-gray-600">
                    üí∞ Facturaci√≥n
                </button>
                <button onclick="showTab('suggestions')" id="tabSuggestions"
                        class="px-6 py-3 rounded-xl font-medium transition-all bg-gray-700 text-gray-300 hover:bg-gray-600 relative">
                    üí° Sugerencias
                    <span id="suggestionBadge" class="hidden absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center animate-pulse font-bold"></span>
                </button>
            </div>
            
            <!-- Tab: Escuelas -->
            <div id="schoolsSection" class="bg-gray-800 rounded-2xl p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-white">Lista de Escuelas</h2>
                    <div class="flex items-center gap-4">
                        <input type="text" id="searchSchools" placeholder="Buscar escuela..."
                               class="px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500"
                               onkeyup="filterSchools()">
                        <select id="filterStatus" onchange="filterSchools()"
                                class="px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                            <option value="all">Todos</option>
                            <option value="activo">Activos</option>
                            <option value="gracia">En Gracia</option>
                            <option value="inactivo">Inactivos</option>
                        </select>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="w-full">
                        <thead>
                            <tr class="text-left text-gray-400 text-sm border-b border-gray-700">
                                <th class="pb-4 font-medium">Club</th>
                                <th class="pb-4 font-medium">Tel√©fono</th>
                                <th class="pb-4 font-medium">Plan</th>
                                <th class="pb-4 font-medium">Vencimiento</th>
                                <th class="pb-4 font-medium">Jugadores</th>
                                <th class="pb-4 font-medium">Estado</th>
                                <th class="pb-4 font-medium">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="schoolsTableBody">
                            <!-- Se llena din√°micamente -->
                        </tbody>
                    </table>
                </div>
                
                <div id="noSchoolsMessage" class="hidden text-center py-12">
                    <div class="text-6xl mb-4">üè´</div>
                    <p class="text-gray-400">No hay escuelas registradas</p>
                </div>
            </div>
            
            <!-- Tab: C√≥digos -->
            <div id="codesSection" class="bg-gray-800 rounded-2xl p-6 hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-white">C√≥digos de Activaci√≥n</h2>
                    <button onclick="showGenerateCodeModal()" 
                            class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg font-medium flex items-center gap-2">
                        <i data-lucide="plus" class="w-4 h-4"></i>
                        Nuevo C√≥digo
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="w-full">
                        <thead>
                            <tr class="text-left text-gray-400 text-sm border-b border-gray-700">
                                <th class="pb-4 font-medium">C√≥digo</th>
                                <th class="pb-4 font-medium">Plan</th>
                                <th class="pb-4 font-medium">Creado</th>
                                <th class="pb-4 font-medium">Expira</th>
                                <th class="pb-4 font-medium">Estado</th>
                                <th class="pb-4 font-medium">Usado Por</th>
                                <th class="pb-4 font-medium">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="codesTableBody">
                            <!-- Se llena din√°micamente -->
                        </tbody>
                    </table>
                </div>
                
                <div id="noCodesMessage" class="hidden text-center py-12">
                    <div class="text-6xl mb-4">üéüÔ∏è</div>
                    <p class="text-gray-400">No hay c√≥digos generados</p>
                </div>
            </div>
            
            <!-- Tab: Alertas -->
            <div id="alertsSection" class="bg-gray-800 rounded-2xl p-6 hidden">
                <h2 class="text-xl font-bold text-white mb-6">‚ö†Ô∏è Alertas de Vencimiento</h2>
                <div id="alertsList">
                    <!-- Se llena din√°micamente -->
                </div>
                <div id="noAlertsMessage" class="hidden text-center py-12">
                    <div class="text-6xl mb-4">‚úÖ</div>
                    <p class="text-gray-400">No hay alertas pendientes</p>
                </div>
            </div>
            
            <!-- Tab: Facturaci√≥n üí∞ NUEVO -->
            <div id="billingSection" class="bg-gray-800 rounded-2xl p-6 hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-white flex items-center gap-2">
                        <i data-lucide="receipt" class="w-6 h-6 text-green-500"></i>
                        Gesti√≥n de Facturaci√≥n
                    </h2>
                    <div class="flex gap-3">
                        <button onclick="showNewPaymentModal()" 
                                class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium flex items-center gap-2">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            Registrar Pago
                        </button>
                        <button onclick="exportBillingReport()" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium flex items-center gap-2">
                            <i data-lucide="download" class="w-4 h-4"></i>
                            Exportar
                        </button>
                    </div>
                </div>
                
                <!-- Filtros de Facturaci√≥n -->
                <div class="flex flex-wrap gap-4 mb-6">
                    <select id="billingFilterMonth" onchange="filterBilling()"
                            class="px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <option value="all">Todos los meses</option>
                        <option value="0">Enero</option>
                        <option value="1">Febrero</option>
                        <option value="2">Marzo</option>
                        <option value="3">Abril</option>
                        <option value="4">Mayo</option>
                        <option value="5">Junio</option>
                        <option value="6">Julio</option>
                        <option value="7">Agosto</option>
                        <option value="8">Septiembre</option>
                        <option value="9">Octubre</option>
                        <option value="10">Noviembre</option>
                        <option value="11">Diciembre</option>
                    </select>
                    <select id="billingFilterYear" onchange="filterBilling()"
                            class="px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <!-- Se llena din√°micamente -->
                    </select>
                    <select id="billingFilterStatus" onchange="filterBilling()"
                            class="px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <option value="all">Todos los estados</option>
                        <option value="pagado">Pagados</option>
                        <option value="pendiente">Pendientes</option>
                        <option value="vencido">Vencidos</option>
                    </select>
                    <input type="text" id="billingSearch" placeholder="Buscar club..."
                           class="px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500"
                           onkeyup="filterBilling()">
                </div>
                
                <!-- Tabla de Facturaci√≥n -->
                <div class="table-container">
                    <table class="w-full">
                        <thead>
                            <tr class="text-left text-gray-400 text-sm border-b border-gray-700">
                                <th class="pb-4 font-medium">Factura</th>
                                <th class="pb-4 font-medium">Club</th>
                                <th class="pb-4 font-medium">Concepto</th>
                                <th class="pb-4 font-medium">Monto</th>
                                <th class="pb-4 font-medium">Fecha</th>
                                <th class="pb-4 font-medium">M√©todo</th>
                                <th class="pb-4 font-medium">Estado</th>
                                <th class="pb-4 font-medium">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="billingTableBody">
                            <!-- Se llena din√°micamente -->
                        </tbody>
                    </table>
                </div>
                
                <div id="noBillingMessage" class="hidden text-center py-12">
                    <div class="text-6xl mb-4">üí∞</div>
                    <p class="text-gray-400">No hay registros de facturaci√≥n</p>
                    <button onclick="showNewPaymentModal()" class="mt-4 bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg">
                        Registrar primer pago
                    </button>
                </div>
            </div>

            <!-- Tab: Sugerencias üí° -->
            <div id="suggestionsSection" class="hidden bg-gray-800 rounded-2xl p-6">
                <div class="flex flex-col md:flex-row items-start md:items-center justify-between mb-6 gap-4">
                    <div>
                        <h2 class="text-xl font-bold text-white flex items-center gap-2">
                            üí° Sugerencias y Comentarios
                        </h2>
                        <p class="text-gray-400 text-sm mt-1">Mensajes de padres y administradores de escuelas</p>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <button data-filter="all" onclick="filterSuggestions('all')" 
                                class="px-4 py-2 rounded-lg bg-teal-600 text-white transition-colors text-sm">
                            üìã Todas
                        </button>
                        <button data-filter="pending" onclick="filterSuggestions('pending')" 
                                class="px-4 py-2 rounded-lg bg-gray-700 text-gray-300 hover:bg-gray-600 transition-colors text-sm">
                            ‚è≥ Pendientes
                        </button>
                        <button data-filter="responded" onclick="filterSuggestions('responded')" 
                                class="px-4 py-2 rounded-lg bg-gray-700 text-gray-300 hover:bg-gray-600 transition-colors text-sm">
                            ‚úÖ Respondidas
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-gray-700 rounded-xl p-4 text-center">
                        <p class="text-3xl font-bold text-white" id="statTotalSuggestions">0</p>
                        <p class="text-gray-400 text-sm">Total</p>
                    </div>
                    <div class="bg-amber-600/20 border border-amber-600 rounded-xl p-4 text-center">
                        <p class="text-3xl font-bold text-amber-400" id="statPendingSuggestions">0</p>
                        <p class="text-amber-300 text-sm">Pendientes</p>
                    </div>
                    <div class="bg-green-600/20 border border-green-600 rounded-xl p-4 text-center">
                        <p class="text-3xl font-bold text-green-400" id="statRespondedSuggestions">0</p>
                        <p class="text-green-300 text-sm">Respondidas</p>
                    </div>
                    <div class="bg-blue-600/20 border border-blue-600 rounded-xl p-4 text-center">
                        <p class="text-3xl font-bold text-blue-400" id="statParentSuggestions">0</p>
                        <p class="text-blue-300 text-sm">De Padres</p>
                    </div>
                </div>
                
                <div id="suggestionsList" class="space-y-4">
                    <div class="text-center py-12 text-gray-500">
                        <span class="text-4xl">‚è≥</span>
                        <p class="mt-4">Cargando sugerencias...</p>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modal Responder Sugerencia -->
    <div id="responseModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto animate-fade-in">
            <div class="p-4 bg-gradient-to-r from-teal-600 to-blue-600 rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold text-white">üí¨ Responder Sugerencia</h3>
                    <button onclick="closeResponseModal()" class="text-white hover:bg-white/20 rounded-lg p-1">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div id="responseSenderInfo" class="bg-gray-700 rounded-lg p-4 mb-4"></div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-400 mb-2">Mensaje original:</label>
                    <div id="responseOriginalMessage" class="bg-gray-700 rounded-lg p-4 text-white"></div>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-300 mb-2">Tu respuesta:</label>
                    <textarea id="responseText" rows="4" 
                        class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500 resize-none"
                        placeholder="Escribe tu respuesta aqu√≠..."></textarea>
                </div>
                
                <div class="flex gap-3">
                    <button onclick="closeResponseModal()" 
                            class="flex-1 border border-gray-600 text-gray-300 py-3 rounded-xl hover:bg-gray-700 transition-colors">
                        Cancelar
                    </button>
                    <button onclick="submitResponse()" 
                            class="flex-1 bg-teal-600 hover:bg-teal-700 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition-colors">
                        <i data-lucide="send" class="w-5 h-5"></i>
                        Enviar Respuesta
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal: Generar C√≥digo -->
    <div id="generateCodeModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md animate-fade-in">
            <div class="p-6 border-b border-gray-700">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-bold text-white flex items-center gap-2">
                        <i data-lucide="ticket" class="w-5 h-5 text-teal-500"></i>
                        Generar C√≥digo de Activaci√≥n
                    </h3>
                    <button onclick="closeGenerateCodeModal()" class="text-gray-400 hover:text-white">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
            
            <form id="generateCodeForm" class="p-6 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Plan de Suscripci√≥n</label>
                    <select id="codePlan" required
                            class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <option value="mensual">Mensual</option>
                        <option value="anual">Anual</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Precio (referencia)</label>
                    <input type="text" id="codePrice" placeholder="Ej: $50.000 COP"
                           class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500">
                    <p class="text-xs text-gray-500 mt-1">Solo para tu referencia, no afecta el sistema</p>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Notas (opcional)</label>
                    <input type="text" id="codeNotes" placeholder="Ej: Cliente Juan P√©rez"
                           class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500">
                </div>
                
                <div class="bg-gray-700 rounded-xl p-4">
                    <p class="text-sm text-gray-400">
                        <i data-lucide="info" class="w-4 h-4 inline mr-1"></i>
                        El c√≥digo ser√° v√°lido por <strong class="text-white">7 d√≠as</strong> para ser usado.
                    </p>
                </div>
                
                <button type="submit" 
                        class="w-full bg-gradient-to-r from-teal-600 to-blue-600 hover:from-teal-700 hover:to-blue-700 text-white font-bold py-3 rounded-xl transition-all">
                    Generar C√≥digo
                </button>
            </form>
        </div>
    </div>
    
    <!-- Modal: C√≥digo Generado -->
    <div id="codeGeneratedModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md animate-fade-in text-center">
            <div class="p-8">
                <div class="text-6xl mb-4">üéâ</div>
                <h3 class="text-xl font-bold text-white mb-2">¬°C√≥digo Generado!</h3>
                <p class="text-gray-400 mb-6">Comparte este c√≥digo con tu cliente</p>
                
                <div class="bg-gray-900 rounded-xl p-6 mb-6">
                    <p id="generatedCodeDisplay" class="text-3xl font-mono font-bold text-teal-400 tracking-wider"></p>
                </div>
                
                <div class="flex gap-3">
                    <button onclick="copyGeneratedCode()" 
                            class="flex-1 bg-teal-600 hover:bg-teal-700 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2">
                        <i data-lucide="copy" class="w-4 h-4"></i>
                        Copiar
                    </button>
                    <button onclick="shareViaWhatsApp()" 
                            class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2">
                        <i data-lucide="message-circle" class="w-4 h-4"></i>
                        WhatsApp
                    </button>
                </div>
                
                <button onclick="closeCodeGeneratedModal()" 
                        class="w-full mt-4 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-xl">
                    Cerrar
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal: Acciones de Escuela -->
    <div id="schoolActionsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-700 sticky top-0 bg-gray-800">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-bold text-white" id="schoolActionTitle">Acciones</h3>
                    <button onclick="closeSchoolActionsModal()" class="text-gray-400 hover:text-white">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <input type="hidden" id="actionSchoolId">
                
                <!-- Info del Club -->
                <div class="bg-gray-700 rounded-xl p-4 mb-6">
                    <div class="flex items-center gap-4">
                        <div class="text-4xl">üè´</div>
                        <div>
                            <h4 id="actionSchoolName" class="font-bold text-white text-lg"></h4>
                            <p id="actionSchoolPhone" class="text-gray-400 text-sm"></p>
                        </div>
                    </div>
                </div>
                
                <!-- Historial de Pagos -->
                <div class="mb-6">
                    <h4 class="font-bold text-white mb-3 flex items-center gap-2">
                        <i data-lucide="history" class="w-4 h-4"></i>
                        Historial de Pagos
                    </h4>
                    <div id="paymentHistoryList" class="max-h-40 overflow-y-auto space-y-2">
                        <!-- Se llena din√°micamente -->
                    </div>
                </div>
                
                <!-- Acciones -->
                <div class="space-y-3">
                    <button onclick="extendSubscription('mensual')" 
                            class="w-full bg-teal-600 hover:bg-teal-700 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2">
                        <i data-lucide="plus-circle" class="w-5 h-5"></i>
                        Extender 1 Mes
                    </button>
                    <button onclick="extendSubscription('anual')" 
                            class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2">
                        <i data-lucide="plus-circle" class="w-5 h-5"></i>
                        Extender 1 A√±o
                    </button>
                    <button onclick="showNewPaymentModalForSchool()" 
                            class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2">
                        <i data-lucide="credit-card" class="w-5 h-5"></i>
                        Registrar Pago + Renovar
                    </button>
                    <button onclick="toggleSchoolStatus()" id="toggleStatusBtn"
                            class="w-full bg-yellow-600 hover:bg-yellow-700 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2">
                        <i data-lucide="power" class="w-5 h-5"></i>
                        <span id="toggleStatusText">Activar/Desactivar</span>
                    </button>
                    <button onclick="sendReminderWhatsApp()" 
                            class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2">
                        <i data-lucide="message-circle" class="w-5 h-5"></i>
                        Enviar Recordatorio WhatsApp
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal: Registrar Pago üí∞ NUEVO -->
    <div id="newPaymentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-700 sticky top-0 bg-gray-800">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-bold text-white flex items-center gap-2">
                        <i data-lucide="credit-card" class="w-5 h-5 text-green-500"></i>
                        Registrar Pago
                    </h3>
                    <button onclick="closeNewPaymentModal()" class="text-gray-400 hover:text-white">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
            
            <form id="newPaymentForm" class="p-6 space-y-4">
                <!-- Seleccionar Club -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Club / Escuela *</label>
                    <select id="paymentClubId" required
                            class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <option value="">Seleccionar club...</option>
                        <!-- Se llena din√°micamente -->
                    </select>
                </div>
                
                <!-- Concepto -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Concepto *</label>
                    <select id="paymentConcept" required
                            class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <option value="licencia_anual">Licencia Anual</option>
                        <option value="licencia_mensual">Licencia Mensual</option>
                        <option value="renovacion_anual">Renovaci√≥n Anual</option>
                        <option value="renovacion_mensual">Renovaci√≥n Mensual</option>
                        <option value="otro">Otro</option>
                    </select>
                </div>
                
                <!-- Concepto personalizado -->
                <div id="customConceptDiv" class="hidden">
                    <label class="block text-sm font-medium text-gray-300 mb-2">Descripci√≥n del concepto</label>
                    <input type="text" id="paymentCustomConcept" placeholder="Describe el concepto..."
                           class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500">
                </div>
                
                <!-- Monto -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Monto (COP) *</label>
                    <input type="number" id="paymentAmount" required min="0" step="1000" placeholder="150000"
                           class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500">
                </div>
                
                <!-- Fecha de Pago -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Fecha de Pago *</label>
                    <input type="date" id="paymentDate" required
                           class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                </div>
                
                <!-- M√©todo de Pago -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">M√©todo de Pago *</label>
                    <select id="paymentMethod" required
                            class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <option value="transferencia">Transferencia Bancaria</option>
                        <option value="efectivo">Efectivo</option>
                        <option value="nequi">Nequi</option>
                        <option value="daviplata">Daviplata</option>
                        <option value="pse">PSE</option>
                        <option value="tarjeta">Tarjeta Cr√©dito/D√©bito</option>
                        <option value="otro">Otro</option>
                    </select>
                </div>
                
                <!-- Estado -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Estado del Pago *</label>
                    <select id="paymentStatus" required
                            class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <option value="pagado">‚úÖ Pagado</option>
                        <option value="pendiente">‚è≥ Pendiente</option>
                    </select>
                </div>
                
                <!-- Renovar licencia autom√°ticamente -->
                <div class="bg-gray-700 rounded-xl p-4">
                    <label class="flex items-center gap-3 cursor-pointer">
                        <input type="checkbox" id="autoRenewLicense" checked
                               class="w-5 h-5 rounded border-gray-500 text-teal-500 focus:ring-teal-500">
                        <div>
                            <span class="text-white font-medium">Renovar licencia autom√°ticamente</span>
                            <p class="text-xs text-gray-400">Extiende la licencia seg√∫n el concepto seleccionado</p>
                        </div>
                    </label>
                </div>
                
                <!-- Notas -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Notas (opcional)</label>
                    <textarea id="paymentNotes" rows="2" placeholder="Observaciones adicionales..."
                              class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500 resize-none"></textarea>
                </div>
                
                <div class="flex gap-3 pt-4">
                    <button type="button" onclick="closeNewPaymentModal()" 
                            class="flex-1 bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-xl font-medium">
                        Cancelar
                    </button>
                    <button type="submit" 
                            class="flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-bold py-3 rounded-xl transition-all">
                        Guardar Pago
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal: Ver Factura üí∞ NUEVO -->
    <div id="viewInvoiceModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-700 sticky top-0 bg-gray-800">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-bold text-white flex items-center gap-2">
                        <i data-lucide="file-text" class="w-5 h-5 text-green-500"></i>
                        Factura / Recibo
                    </h3>
                    <button onclick="closeViewInvoiceModal()" class="text-gray-400 hover:text-white">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
            
            <!-- Contenido de la Factura -->
            <div id="invoiceContent" class="p-6 bg-white text-gray-900">
                <!-- Se llena din√°micamente -->
            </div>
            
            <div class="p-6 border-t border-gray-700 flex gap-3">
                <button onclick="downloadInvoicePDF()" 
                        class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2">
                    <i data-lucide="download" class="w-5 h-5"></i>
                    Descargar PDF
                </button>
                <button onclick="shareInvoiceWhatsApp()" 
                        class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-medium flex items-center justify-center gap-2">
                    <i data-lucide="message-circle" class="w-5 h-5"></i>
                    Enviar por WhatsApp
                </button>
            </div>
        </div>
    </div>
    
    <!-- Toast -->
    <div id="toast" class="hidden fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg z-50 border border-gray-700"></div>
    
    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, doc, setDoc, getDoc, getDocs, updateDoc, deleteDoc, query, where, orderBy } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        
        // Configuraci√≥n Firebase (misma que tu app)
        const firebaseConfig = {
            apiKey: "AIzaSyBThVgzEsTLWSW7puKOVErZ_KOLDEq8v3A",
            authDomain: "my-club-fae98.firebaseapp.com",
            projectId: "my-club-fae98",
            storageBucket: "my-club-fae98.firebasestorage.app",
            messagingSenderId: "807792685568",
            appId: "1:807792685568:web:06097faad391a9fd8c9ee5"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        // Hacer disponible globalmente
        window.firebaseAdmin = { db, auth, collection, doc, setDoc, getDoc, getDocs, updateDoc, deleteDoc, query, where, orderBy, signInWithEmailAndPassword, signOut, onAuthStateChanged };
        
        // ‚úÖ Sin emails hardcodeados - La verificaci√≥n se hace contra Firestore
        console.log('‚úÖ Firebase Admin cargado');
    </script>
    
    <script src="./admin.js"></script>
    <script src="../js/super-admin-sugerencias.js"></script>
    
    <script>
        // Inicializar Lucide Icons
        lucide.createIcons();
    </script>
    
    <!-- Bot√≥n de instalaci√≥n PWA -->
    <button id="installBtn" class="install-btn hidden bg-teal-600 hover:bg-teal-700 text-white px-4 py-3 rounded-xl shadow-lg flex items-center gap-2 transition-all">
        <i data-lucide="download" class="w-5 h-5"></i>
        <span>Instalar App</span>
    </button>
    
    <!-- Service Worker y PWA -->
    <script>
        // Variables para la instalaci√≥n
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');
        
        // Detectar si es m√≥vil
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        // Registrar Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('./sw.js');
                    console.log('‚úÖ Service Worker registrado:', registration.scope);
                    
                    // Verificar actualizaciones
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // Hay una nueva versi√≥n disponible
                                if (confirm('üîÑ Hay una nueva versi√≥n disponible. ¬øActualizar ahora?')) {
                                    newWorker.postMessage({ type: 'SKIP_WAITING' });
                                    window.location.reload();
                                }
                            }
                        });
                    });
                } catch (error) {
                    console.error('‚ùå Error al registrar Service Worker:', error);
                }
            });
        }
        
        // Capturar evento de instalaci√≥n
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('üì± PWA instalable detectada');
            
            if (!isMobile) {
                e.preventDefault();
                deferredPrompt = e;
                
                if (installBtn) {
                    installBtn.classList.remove('hidden');
                    lucide.createIcons();
                }
            } else {
                deferredPrompt = e;
                console.log('üì± M√≥vil detectado - Usando banner nativo de Chrome');
                
                setTimeout(() => {
                    if (installBtn && deferredPrompt) {
                        installBtn.classList.remove('hidden');
                        lucide.createIcons();
                    }
                }, 2000);
            }
        });
        
        // Manejar click en bot√≥n de instalaci√≥n
        if (installBtn) {
            installBtn.addEventListener('click', async () => {
                if (!deferredPrompt) {
                    console.log('‚ö†Ô∏è No hay prompt de instalaci√≥n disponible');
                    return;
                }
                
                deferredPrompt.prompt();
                
                const { outcome } = await deferredPrompt.userChoice;
                console.log('üì± Resultado de instalaci√≥n:', outcome);
                
                if (outcome === 'accepted') {
                    console.log('‚úÖ PWA instalada');
                    installBtn.classList.add('hidden');
                }
                
                deferredPrompt = null;
            });
        }
        
        // Detectar si ya est√° instalada
        window.addEventListener('appinstalled', () => {
            console.log('‚úÖ PWA instalada exitosamente');
            if (installBtn) {
                installBtn.classList.add('hidden');
            }
            deferredPrompt = null;
        });
        
        // Verificar si ya est√° en modo standalone (instalada)
        if (window.matchMedia('(display-mode: standalone)').matches) {
            console.log('üì± Ejecutando como PWA instalada');
            if (installBtn) {
                installBtn.classList.add('hidden');
            }
        }
    </script>
</body>
</html>