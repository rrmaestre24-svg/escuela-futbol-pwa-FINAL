<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0d9488">
    <meta name="description" content="Gesti√≥n completa de escuelas de f√∫tbol infantil">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    
    <title>MY CLUB - Gesti√≥n Escuelas de F√∫tbol</title>

    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
    tailwind.config = {
        darkMode: 'class'
    }
</script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚öΩ</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚öΩ</text></svg>">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">

   
    <!-- ========================================
         APLICACI√ìN PRINCIPAL (Despu√©s del login)
    ========================================= -->
    <div id="appContainer" class="">
        
        <!-- Top Bar -->
        <header class="bg-white dark:bg-gray-800 shadow-sm fixed top-0 left-0 right-0 z-40">
            <div class="flex items-center justify-between px-4 py-3">
                <div class="flex items-center gap-3">
                    <img id="headerLogo" src="" alt="Logo" class="w-10 h-10 rounded-lg object-cover">
                    <div>
                        <h1 id="headerClubName" class="font-bold text-gray-800 dark:text-white">MY CLUB</h1>
                        <p id="headerViewName" class="text-xs text-gray-500 dark:text-gray-400">Dashboard</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
            <!-- Bot√≥n de Instalaci√≥n (solo visible si se puede instalar) -->
            <div class="flex items-center gap-2">
            <!-- Bot√≥n de Instalaci√≥n (solo visible si se puede instalar) -->
            <button id="installButton" class="hidden p-2 rounded-lg bg-teal-600 hover:bg-teal-700 text-white transition-colors animate-pulse" onclick="installPWA()" title="Instalar aplicaci√≥n">
                <i data-lucide="download" class="w-5 h-5"></i>
            </button>
            
            <button onclick="toggleDarkMode()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="moon" class="w-5 h-5 text-gray-600 dark:text-gray-300"></i>
            </button>
            <button onclick="showNotificationsView()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors relative">
            <!-- Ejemplo: en el men√∫ de navegaci√≥n -->
        <li class="nav-item" data-nav="notifications">
        <button class="nav-link flex items-center gap-2">
            <i data-lucide="bell" class="w-5 h-5"></i>
            <span id="notificationBadge" class="hidden bg-red-500 text-white text-xs rounded-full px-2 py-1">0</span>
        </button>
        </li>  
    </header>

        <!-- Main Content -->
        <main class="pt-16 pb-20 min-h-screen">
            
            <!-- ========================================
                 VISTA: DASHBOARD
            ========================================= -->
            <div id="dashboardView" class="p-4 space-y-4">
                <!-- Stats Cards -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                        <div class="flex items-center gap-3">
                            <div class="p-3 bg-teal-100 dark:bg-teal-900 rounded-lg">
                                <i data-lucide="users" class="w-6 h-6 text-teal-600 dark:text-teal-400"></i>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Jugadores</p>
                                <p id="statPlayers" class="text-2xl font-bold text-gray-800 dark:text-white">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                        <div class="flex items-center gap-3">
                            <div class="p-3 bg-red-100 dark:bg-red-900 rounded-lg">
                                <i data-lucide="alert-circle" class="w-6 h-6 text-red-600 dark:text-red-400"></i>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Pendientes</p>
                                <p id="statPending" class="text-2xl font-bold text-gray-800 dark:text-white">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                        <div class="flex items-center gap-3">
                            <div class="p-3 bg-green-100 dark:bg-green-900 rounded-lg">
                                <i data-lucide="dollar-sign" class="w-6 h-6 text-green-600 dark:text-green-400"></i>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Este Mes</p>
                                <p id="statIncome" class="text-xl font-bold text-gray-800 dark:text-white">$0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                        <div class="flex items-center gap-3">
                            <div class="p-3 bg-blue-100 dark:bg-blue-900 rounded-lg">
                                <i data-lucide="calendar" class="w-6 h-6 text-blue-600 dark:text-blue-400"></i>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Eventos</p>
                                <p id="statEvents" class="text-2xl font-bold text-gray-800 dark:text-white">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cumplea√±os Pr√≥ximos -->
                <!-- Cumplea√±os Pr√≥ximos -->
                    <div id="upcomingBirthdaysCard" class="hidden bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl p-4 shadow-lg text-white">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center gap-2">
                        <i data-lucide="cake" class="w-6 h-6"></i>
                        <h3 class="font-bold text-lg">Cumplea√±os Pr√≥ximos</h3>
                        </div>
                        <button onclick="navigateTo('birthdays')" class="text-sm underline">Ver todos</button>
                    </div>
                    <div id="upcomingBirthdaysList" class="space-y-2"></div> <!-- üëà ESTE ES EL CONTENEDOR QUE FALTA -->
                    </div>

                <!-- Pr√≥ximos Eventos -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-bold text-gray-800 dark:text-white flex items-center gap-2">
                            <i data-lucide="calendar-days" class="w-5 h-5 text-blue-600"></i>
                            Pr√≥ximos Eventos
                        </h3>
                        <button onclick="navigateTo('calendar')" class="text-sm text-teal-600 dark:text-teal-400">Ver todo</button>
                    </div>
                    <div id="dashboardEventsList" class="space-y-2"></div>
                </div>

                <!-- Notificaciones Recientes -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-bold text-gray-800 dark:text-white flex items-center gap-2">
                            <i data-lucide="bell-ring" class="w-5 h-5 text-red-600"></i>
                            Notificaciones Recientes
                        </h3>
                        <button onclick="showNotificationsView()" class="text-sm text-teal-600 dark:text-teal-400">Ver todas</button>
                    </div>
                    <div id="dashboardNotificationsList" class="space-y-4"></div>
                </div>

              <!-- Bot√≥n Contabilidad -->
                <button onclick="navigateTo('accounting')" class="w-full bg-gradient-to-r from-teal-600 to-blue-600 text-white font-bold py-4 rounded-xl shadow-lg flex items-center justify-center gap-2 hover:shadow-xl transition-all transform hover:scale-105">
                <i data-lucide="trending-up" class="w-6 h-6"></i>
                Ver Contabilidad Completa
                </button>
            </div>

            <!-- ========================================
                 VISTA: JUGADORES
            ========================================= -->
           <!-- ========================================
     VISTA: JUGADORES - CON FILTROS DE ESTADO
========================================= -->
<div id="playersView" class="hidden p-4 space-y-4">
    <!-- Buscador y bot√≥n agregar -->
    <div class="flex gap-2">
        <div class="flex-1 relative">
            <input type="text" id="playerSearch" placeholder="Buscar jugador..." class="w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-800 dark:text-white">
            <i data-lucide="search" class="w-5 h-5 text-gray-400 absolute left-3 top-2.5"></i>
        </div>
        <button onclick="showAddPlayerModal()" class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg flex items-center gap-2">
            <i data-lucide="user-plus" class="w-5 h-5"></i>
            Agregar
        </button>
    </div>

    <!-- ‚≠ê NUEVO: Filtros por estado -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-3 shadow-sm">
        <div class="flex items-center gap-2 overflow-x-auto">
            <span class="text-sm font-medium text-gray-600 dark:text-gray-400 mr-2">Filtrar:</span>
            <button 
                onclick="filterByStatus('todos')" 
                data-status-filter="todos"
                class="px-4 py-2 rounded-lg text-sm font-medium transition-all bg-teal-600 text-white whitespace-nowrap"
            >
                Todos
            </button>
            <button 
                onclick="filterByStatus('activo')" 
                data-status-filter="activo"
                class="px-4 py-2 rounded-lg text-sm font-medium transition-all bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 whitespace-nowrap flex items-center gap-1"
            >
                <span class="text-green-600">‚óè</span>
                Activos
            </button>
            <button 
                onclick="filterByStatus('inactivo')" 
                data-status-filter="inactivo"
                class="px-4 py-2 rounded-lg text-sm font-medium transition-all bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 whitespace-nowrap flex items-center gap-1"
            >
                <span class="text-red-600">‚óè</span>
                Inactivos
            </button>
        </div>
    </div>

    <!-- Lista de jugadores -->
    <div id="playersList" class="space-y-3"></div>
</div>

<!-- ========================================
    VISTA: PAGOS (UNIFICADA)
========================================= -->
<div id="paymentsView" class="hidden p-4 space-y-4">
    <!-- Selector de Tab (Dropdown) -->
    <div class="relative mb-3">
            <select 
                id="paymentTabSelect" 
                onchange="showPaymentTab(this.value)"
                class="w-full px-4 py-3 rounded-lg bg-gradient-to-r from-teal-600 to-blue-600 text-white font-bold text-base appearance-none cursor-pointer shadow-lg focus:ring-2 focus:ring-teal-400 focus:outline-none">
                <option value="monthly">üìÖ Mensualidades</option>
                <option value="extras">üéΩ Extras</option>
                <option value="expenses">üí∏ Egresos</option>
                <option value="thirdParty">üí∞ Otros Ingresos</option>
                <option value="history">üìã Historial</option>
            </select>
            <div class="absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none">
                <i data-lucide="chevron-down" class="w-5 h-5 text-white"></i>
            </div>
        </div>
                
                <!-- Buscador + Bot√≥n Registrar -->
                <div class="flex gap-2">
                    <!-- Bot√≥n Buscar -->
                    <button 
                        type="button"
                        onclick="togglePaymentSearch()" 
                        class="bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white px-4 py-3 rounded-lg flex items-center gap-2 active:scale-95 transition-transform"
                        style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px;"
                        aria-label="Buscar pagos">
                        <i data-lucide="search" class="w-5 h-5"></i>
                        <span class="hidden sm:inline">Buscar</span>
                    </button>
                    
                    <!-- Bot√≥n Registrar Pago -->
                    <button 
                        type="button"
                        onclick="showUnifiedPaymentModal()" 
                        class="flex-1 bg-gradient-to-r from-teal-600 to-blue-600 hover:from-teal-700 hover:to-blue-700 text-white py-3 rounded-lg flex items-center justify-center gap-2 shadow-lg active:scale-95 transition-all"
                        style="touch-action: manipulation; min-height: 44px;">
                        <i data-lucide="plus-circle" class="w-6 h-6"></i>
                        <span class="font-bold">Registrar Pago</span>
                    </button>
                </div>

                <!-- Campo de b√∫squeda (oculto por defecto) -->
                <div id="paymentSearchContainer" class="hidden">
                    <div class="relative">
                        <input 
                            type="search"
                            id="paymentSearchInput" 
                            placeholder="Buscar por jugador, concepto, factura, monto..."
                            oninput="searchPayments()"
                            class="w-full px-4 py-3 pl-12 pr-12 rounded-lg border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
                            style="font-size: 16px;"
                            autocomplete="off"
                            autocorrect="off"
                            autocapitalize="off"
                            spellcheck="false"
                        >
                        <i data-lucide="search" class="absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"></i>
                        <button 
                            type="button"
                            onclick="clearPaymentSearch()" 
                            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 active:scale-90 transition-transform"
                            style="touch-action: manipulation; min-height: 44px; min-width: 44px;"
                            title="Limpiar b√∫squeda"
                            aria-label="Limpiar b√∫squeda">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-2 ml-1">
                        Busca por nombre, categor√≠a, concepto, n√∫mero de factura o monto
                    </p>
                </div>

                <!-- Contenido de tabs -->
                <div id="monthlyPaymentsContent" class="space-y-3"></div>
                <div id="extrasPaymentsContent" class="hidden space-y-3"></div>
                <div id="expensesPaymentsContent" class="hidden space-y-3"></div>
                <div id="thirdPartyIncomesContent" class="hidden space-y-3"></div>
                <div id="historyPaymentsContent" class="hidden">
                    <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b border-gray-200 dark:border-gray-700">
                                    <th class="text-left py-2 text-gray-600 dark:text-gray-300">Fecha</th>
                                    <th class="text-left py-2 text-gray-600 dark:text-gray-300">Jugador</th>
                                    <th class="text-left py-2 text-gray-600 dark:text-gray-300">Concepto</th>
                                    <th class="text-right py-2 text-gray-600 dark:text-gray-300">Monto</th>
                                    <th class="text-center py-2 text-gray-600 dark:text-gray-300">Estado</th>
                                </tr>
                            </thead>
                            <tbody id="paymentsHistoryTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========================================
                 VISTA: CALENDARIO
            ========================================= -->
            <div id="calendarView" class="hidden p-4 space-y-4">
                <!-- Controles -->
                <div class="flex items-center justify-between bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                    <button onclick="previousMonth()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                        <i data-lucide="chevron-left" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
                    </button>
                    <h3 id="calendarMonthYear" class="font-bold text-lg text-gray-800 dark:text-white"></h3>
                    <button onclick="nextMonth()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                        <i data-lucide="chevron-right" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
                    </button>
                </div>

                <button onclick="showAddEventModal()" class="w-full bg-teal-600 hover:bg-teal-700 text-white py-3 rounded-lg flex items-center justify-center gap-2">
                    <i data-lucide="plus-circle" class="w-5 h-5"></i>
                    Agregar Evento
                </button>

                <!-- Grid del calendario -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                    <div class="grid grid-cols-7 gap-1 mb-2">
                        <div class="text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2">Dom</div>
                        <div class="text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2">Lun</div>
                        <div class="text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2">Mar</div>
                        <div class="text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2">Mi√©</div>
                        <div class="text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2">Jue</div>
                        <div class="text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2">Vie</div>
                        <div class="text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2">S√°b</div>
                    </div>
                    <div id="calendarGrid" class="grid grid-cols-7 gap-1"></div>
                </div>

                <!-- Leyenda -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                    <h4 class="font-medium text-gray-800 dark:text-white mb-3">Leyenda</h4>
                    <div class="grid grid-cols-2 gap-2">
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded bg-blue-500"></div>
                            <span class="text-sm text-gray-600 dark:text-gray-300">Partido</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded bg-green-500"></div>
                            <span class="text-sm text-gray-600 dark:text-gray-300">Entrenamiento</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded bg-yellow-500"></div>
                            <span class="text-sm text-gray-600 dark:text-gray-300">Torneo</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded bg-purple-500"></div>
                            <span class="text-sm text-gray-600 dark:text-gray-300">Otro Evento</span>
                        </div>
                    </div>
                </div>

                <!-- Pr√≥ximos eventos -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                    <h4 class="font-medium text-gray-800 dark:text-white mb-3">Pr√≥ximos Eventos</h4>
                    <div id="upcomingEventsList" class="space-y-2"></div>
                </div>
            </div>

           <!-- ========================================
VISTA: CONFIGURACI√ìN - MEJORADA PARA MOBILE
========================================= -->
<div id="settingsView" class="hidden p-4 space-y-4">
  <!-- Secci√≥n: Mi Perfil -->
   <div id="clubSettingsSection"></div>
  <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden">
    <button onclick="toggleSection('profileSection')" class="w-full px-4 py-3 flex items-center justify-between bg-gray-50 dark:bg-gray-700 text-left font-medium">
      <span>üë§ Mi Perfil</span>
      <i data-lucide="chevron-down" class="w-5 h-5 text-gray-500 dark:text-gray-400"></i>
    </button>
    <div id="profileSection" class="p-4 border-t border-gray-200 dark:border-gray-700 hidden">
      <div class="flex items-center gap-4 mb-4">
        <img id="userAvatar" src="" alt="Avatar" class="w-20 h-20 rounded-full object-cover border-4 border-teal-500">
        <div>
          <input type="file" id="changeAvatar" accept="image/*" class="hidden">
          <button type="button" onclick="document.getElementById('changeAvatar').click()" class="text-sm text-teal-600 dark:text-teal-400 underline">Cambiar foto</button>
        </div>
      </div>
      <form id="userProfileForm" class="space-y-3">
        <input type="text" id="userName" placeholder="Nombre completo" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        <input type="date" id="userBirthDate" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        <input type="tel" id="userPhone" placeholder="Tel√©fono" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        <button type="submit" class="w-full bg-teal-600 hover:bg-teal-700 text-white py-2 rounded-lg">Guardar Cambios</button>
      </form>
    </div>
  </div>

  <!-- Secci√≥n: Seguridad y Contrase√±a -->
  <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden">
    <button onclick="toggleSection('securitySection')" class="w-full px-4 py-3 flex items-center justify-between bg-gray-50 dark:bg-gray-700 text-left font-medium">
      <span>üîí Seguridad y Contrase√±a</span>
      <i data-lucide="chevron-down" class="w-5 h-5 text-gray-500 dark:text-gray-400"></i>
    </button>
    <div id="securitySection" class="p-4 border-t border-gray-200 dark:border-gray-700 hidden">
      <div class="mb-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
        <p class="text-sm text-gray-500 dark:text-gray-400">Email de acceso</p>
        <p id="userEmailDisplay" class="font-medium text-gray-800 dark:text-white"></p>
      </div>
      <form id="changePasswordForm" class="space-y-3">
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Contrase√±a Actual *</label>
          <div class="relative">
            <input type="password" id="currentPassword" required class="w-full px-4 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
            <button type="button" onclick="togglePasswordVisibility('currentPassword')" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
              <i data-lucide="eye" class="w-5 h-5"></i>
            </button>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nueva Contrase√±a *</label>
          <div class="relative">
            <input type="password" id="newPassword" required minlength="6" class="w-full px-4 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
            <button type="button" onclick="togglePasswordVisibility('newPassword')" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
              <i data-lucide="eye" class="w-5 h-5"></i>
            </button>
          </div>
          <div class="mt-2">
            <div class="h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden">
              <div id="passwordStrength" class="h-full transition-all duration-300" style="width: 0%"></div>
            </div>
            <p id="passwordStrengthText" class="text-xs text-gray-500 dark:text-gray-400 mt-1"></p>
          </div>
          <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">M√≠nimo 6 caracteres</p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Confirmar Nueva Contrase√±a *</label>
          <div class="relative">
            <input type="password" id="confirmPassword" required minlength="6" class="w-full px-4 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
            <button type="button" onclick="togglePasswordVisibility('confirmPassword')" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
              <i data-lucide="eye" class="w-5 h-5"></i>
            </button>
          </div>
        </div>
        <button type="submit" class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg flex items-center justify-center gap-2">
          <i data-lucide="key" class="w-5 h-5"></i>
          Cambiar Contrase√±a
        </button>
      </form>
    </div>
  </div>

  <!-- Secci√≥n: Datos del Club -->
  <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden">
    <button onclick="toggleSection('clubSection')" class="w-full px-4 py-3 flex items-center justify-between bg-gray-50 dark:bg-gray-700 text-left font-medium">
      <span>‚öΩ Datos del Club</span>
      <i data-lucide="chevron-down" class="w-5 h-5 text-gray-500 dark:text-gray-400"></i>
    </button>
    <div id="clubSection" class="p-4 border-t border-gray-200 dark:border-gray-700 hidden">
      <div class="flex items-center gap-4 mb-4">
        <img id="clubLogo" src="" alt="Logo" class="w-20 h-20 rounded-lg object-cover border-2 border-gray-300">
        <div>
          <input type="file" id="changeClubLogo" accept="image/*" class="hidden">
          <button onclick="document.getElementById('changeClubLogo').click()" class="text-sm text-teal-600 dark:text-teal-400 underline">Cambiar logo</button>
          <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">M√°ximo 2MB</p>
        </div>
      </div>
      <form id="clubSettingsForm" class="space-y-3">
        <input type="text" id="clubName" placeholder="Nombre del club" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        <!-- Campo para Club ID -->
        <div class="mb-4">
          <label class="block text-gray-700 dark:text-gray-300 text-sm font-medium mb-2">
            ID √∫nico del club <span class="text-red-500">*</span>
          </label>
          <p class="text-xs text-gray-500 dark:text-gray-400 mb-2">
            Este ID identifica tu club en la nube. No se puede cambiar.
          </p>
          <input
            type="text"
            id="clubIdInput"
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white"
            placeholder="club_mi_escuela"
            readonly>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <input type="email" id="clubEmail" placeholder="Email del club" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
          <input type="tel" id="clubPhone" placeholder="Tel√©fono" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        </div>
        <input type="text" id="clubAddress" placeholder="Direcci√≥n" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        <div class="grid grid-cols-2 gap-3">
          <input type="text" id="clubCity" placeholder="Ciudad" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
          <input type="text" id="clubCountry" placeholder="Pa√≠s" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        </div>
        <input type="url" id="clubWebsite" placeholder="Sitio web" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        <input type="text" id="clubSocial" placeholder="Redes sociales (@usuario)" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        <div class="grid grid-cols-2 gap-3">
          <input type="number" id="clubFoundedYear" placeholder="A√±o de fundaci√≥n" min="1900" max="2024" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
          <input type="number" id="clubMonthlyFee" placeholder="Cuota mensual" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
        </div>
        <!-- Color Primario -->
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Color Primario del Club</label>
          <div class="flex gap-3 items-center">
            <input type="color" id="clubPrimaryColor" class="w-20 h-10 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer">
            <div id="colorPreview" class="flex-1 h-10 rounded-lg border-2 border-gray-300 dark:border-gray-600"></div>
          </div>
          <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Este color personalizar√° toda la aplicaci√≥n</p>
        </div>
        <button type="submit" class="w-full bg-teal-600 hover:bg-teal-700 text-white py-2 rounded-lg">Guardar Cambios</button>
      </form>
    </div>
  </div>

  <!-- Secci√≥n: Gesti√≥n de Usuarios -->
  <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden">
    <button onclick="toggleSection('usersSection')" class="w-full px-4 py-3 flex items-center justify-between bg-gray-50 dark:bg-gray-700 text-left font-medium">
      <span>üë• Gesti√≥n de Usuarios</span>
      <i data-lucide="chevron-down" class="w-5 h-5 text-gray-500 dark:text-gray-400"></i>
    </button>
    <div id="usersSection" class="p-4 border-t border-gray-200 dark:border-gray-700 hidden">
      <div class="flex items-center justify-between mb-4">
        <h3 class="font-bold text-gray-800 dark:text-white flex items-center gap-2">
          <i data-lucide="users" class="w-5 h-5 text-blue-600"></i>
          Usuarios de la Escuela
        </h3>
        <div id="usersCounter"></div>
      </div>
      <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
        Puedes agregar hasta 5 usuarios adicionales que tendr√°n acceso completo a toda la informaci√≥n de la escuela.
      </p>
      <div id="schoolUsersList" class="space-y-2 mb-4">
        <!-- Aqu√≠ se cargan los usuarios din√°micamente -->
      </div>
      <button onclick="showAddSchoolUserModal()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg flex items-center justify-center gap-2 transition-colors">
        <i data-lucide="user-plus" class="w-5 h-5"></i>
        Agregar Usuario
      </button>
    </div>
  </div>

  <!-- Secci√≥n: Personalizaci√≥n -->
  <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden">
    <button onclick="toggleSection('personalizationSection')" class="w-full px-4 py-3 flex items-center justify-between bg-gray-50 dark:bg-gray-700 text-left font-medium">
      <span>üé® Recursos Locales </span>
      <i data-lucide="chevron-down" class="w-5 h-5 text-gray-500 dark:text-gray-400"></i>
    </button>
    <div id="personalizationSection" class="p-4 border-t border-gray-200 dark:border-gray-700 hidden">
      <div class="flex items-center justify-between mb-4">
        <span class="text-gray-800 dark:text-white">Modo Oscuro</span>
        <button onclick="toggleDarkMode()" id="darkModeToggle" class="w-12 h-6 bg-gray-300 dark:bg-teal-600 rounded-full relative transition-colors">
          <div class="w-5 h-5 bg-white rounded-full absolute top-0.5 left-0.5 dark:left-6 transition-all"></div>
        </button>
      </div>
      <div class="space-y-2">
        <button onclick="clearAppCache()" class="w-full border border-blue-600 text-blue-600 dark:text-blue-400 py-2 rounded-lg flex items-center justify-center gap-2 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors">
          <i data-lucide="refresh-cw" class="w-5 h-5"></i>
          Descargar Actualizacion
        </button>
        <button onclick="exportData()" class="w-full border border-teal-600 text-teal-600 dark:text-teal-400 py-2 rounded-lg flex items-center justify-center gap-2 hover:bg-teal-50 dark:hover:bg-teal-900/20 transition-colors">
          <i data-lucide="download" class="w-5 h-5"></i>
          Exportar Datos (JSON)
        </button>
        <button onclick="openImportDialog()" class="w-full border border-green-600 text-green-600 dark:text-green-400 py-2 rounded-lg flex items-center justify-center gap-2 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors">
          <i data-lucide="upload" class="w-5 h-5"></i>
          Importar Datos (JSON)
        </button>
      </div>
    </div>
  </div>

  <!-- Secci√≥n: Sincronizaci√≥n y Cierre -->
  <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden">
    <button onclick="toggleSection('syncSection')" class="w-full px-4 py-3 flex items-center justify-between bg-gray-50 dark:bg-gray-700 text-left font-medium">
      <span>‚òÅÔ∏è Sincronizaci√≥n y Cierre</span>
      <i data-lucide="chevron-down" class="w-5 h-5 text-gray-500 dark:text-gray-400"></i>
    </button>
    <div id="syncSection" class="p-4 border-t border-gray-200 dark:border-gray-700 hidden">
      <div class="mb-4">
        <h4 class="font-bold text-gray-800 dark:text-white mb-2">Subir a Firebase</h4>
        <p class="text-sm text-gray-600 dark:text-gray-400">Guarda tus datos en la nube.</p>
        <button type="button" class="w-full bg-teal-600 hover:bg-teal-700 text-white py-2 rounded-lg"
        onclick="syncAllToFirebase()">
          Subir datos
        </button>
      </div>
      <div class="mb-4">
        <h4 class="font-bold text-gray-800 dark:text-white mb-2">Sincronizar con la nube</h4>
        <p class="text-sm text-gray-600 dark:text-gray-400">Descarga los datos m√°s recientes desde Firebase.</p>
        <button
        onclick="downloadFromFirebase()"
        class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg flex items-center justify-center gap-2 transition-colors">
          <span></span>Descargar datos
        </button>
      </div>
      <div class="border-t border-gray-300 dark:border-gray-600 pt-3 mt-3">
        <button onclick="logout()" class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg flex items-center justify-center gap-2 transition-colors">
          <i data-lucide="log-out" class="w-5 h-5"></i>
          Cerrar Sesi√≥n
        </button>
        <button onclick="clearAllData()" class="w-full bg-gray-700 hover:bg-gray-800 text-white py-2 rounded-lg flex items-center justify-center gap-2 mt-3 transition-colors">
          <i data-lucide="trash-2" class="w-5 h-5"></i>
          Borrar Todos los Datos
        </button>
      </div>
    </div>
  </div>
</div>

            <!-- ========================================
                 VISTA: CUMPLEA√ëOS
            ========================================= -->
            <div id="birthdaysView" class="hidden p-4 space-y-4">
                <div class="bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl p-6 text-white text-center">
                    <i data-lucide="cake" class="w-16 h-16 mx-auto mb-2"></i>
                    <h2 class="text-2xl font-bold">Cumplea√±os del A√±o</h2>
                    <p class="text-sm opacity-90 mt-1">Jugadores y Staff</p>
                </div>
                
                <div id="birthdaysByMonth" class="space-y-4"></div>
            </div>

            <!-- ========================================
                 VISTA: NOTIFICACIONES
            ========================================= -->
            <div id="notificationsView" class="hidden p-4 space-y-4">
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                    <h3 class="font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2">
                        <i data-lucide="bell-ring" class="w-6 h-6 text-red-600"></i>
                        Notificaciones de Pago
                    </h3>
                    <div id="notificationsList" class="space-y-3"></div>
                </div>
            </div>

            <!-- ======================================== 
                VISTA DE CONTABILIDAD - CON EGRESOS
            ========================================= -->
            <div id="accountingView" class="hidden p-4 space-y-4">
            
            <!-- ========================================
                RESUMEN FINANCIERO (6 TARJETAS)
            ========================================= -->
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                
                <!-- üí∞ Total Ingresos -->
                <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-4 text-white shadow-lg">
                <p class="text-xs opacity-90">üí∞ Total Ingresos</p>
                <p id="accTotalIncome" class="text-2xl font-bold mt-1">$0</p>
                </div>
                
                <!-- üí∏ Total Egresos -->
                <div class="bg-gradient-to-br from-red-500 to-red-600 rounded-xl p-4 text-white shadow-lg">
                <p class="text-xs opacity-90">üí∏ Total Egresos</p>
                <p id="accTotalExpenses" class="text-2xl font-bold mt-1">$0</p>
                </div>
                
                <!-- üìä Utilidad Neta -->
                <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-4 text-white shadow-lg">
                <p class="text-xs opacity-90">üìä Utilidad Neta</p>
                <p id="accNetProfit" class="text-2xl font-bold mt-1">$0</p>
                </div>
                
                <!-- üìÖ Ingresos Este Mes -->
                <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 text-white shadow-lg">
                <p class="text-xs opacity-90">üìÖ Este Mes (Ing)</p>
                <p id="accMonthIncome" class="text-2xl font-bold mt-1">$0</p>
                </div>
                
                <!-- ‚ö†Ô∏è Por Cobrar -->
                <div class="bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-xl p-4 text-white shadow-lg">
                <p class="text-xs opacity-90">‚ö†Ô∏è Por Cobrar</p>
                <p id="accPending" class="text-2xl font-bold mt-1">$0</p>
                </div>
                
                <!-- ‚úÖ Pagos Realizados -->
                <div class="bg-gradient-to-br from-teal-500 to-teal-600 rounded-xl p-4 text-white shadow-lg">
                <p class="text-xs opacity-90">‚úÖ Pagos Hechos</p>
                <p id="accPaidCount" class="text-2xl font-bold mt-1">0</p>
                </div>
                
            </div>
            
            <!-- ========================================
                GR√ÅFICO PRINCIPAL (INGRESOS VS EGRESOS)
            ========================================= -->
            <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                <div class="flex items-center justify-between mb-4">
                <h4 class="font-bold text-gray-800 dark:text-white">üìä Ingresos vs Egresos (√öltimos 12 meses)</h4>
                <div class="flex gap-3 text-sm">
                    <div class="flex items-center gap-2">
                    <div class="w-3 h-3 bg-teal-600 rounded"></div>
                    <span class="text-gray-600 dark:text-gray-400">Ingresos</span>
                    </div>
                    <div class="flex items-center gap-2">
                    <div class="w-3 h-3 bg-red-600 rounded"></div>
                    <span class="text-gray-600 dark:text-gray-400">Egresos</span>
                    </div>
                </div>
                </div>
                <canvas id="incomeByMonthChart"></canvas>
            </div>
            
            <!-- ========================================
                GR√ÅFICOS ADICIONALES (OPCIONAL)
            ========================================= -->
            <div class="grid md:grid-cols-2 gap-4">
                
                <!-- Gr√°fico por Categor√≠a -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                <h4 class="font-bold text-gray-800 dark:text-white mb-4">Ingresos por Categor√≠a</h4>
                <canvas id="incomeByCategoryChart"></canvas>
                </div>
                
                <!-- Gr√°fico por Tipo -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                <h4 class="font-bold text-gray-800 dark:text-white mb-4">Ingresos por Tipo</h4>
                <canvas id="incomeByTypeChart"></canvas>
                </div>
                
            </div>
            
            <!-- ========================================
                TABLA DE JUGADORES
            ========================================= -->
            <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                <h4 class="font-bold text-gray-800 dark:text-white mb-4">üìã Estado por Jugador</h4>
                <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead>
                    <tr class="border-b border-gray-200 dark:border-gray-700">
                        <th class="text-left py-2 text-gray-600 dark:text-gray-300">Jugador</th>
                        <th class="text-left py-2 text-gray-600 dark:text-gray-300">Categor√≠a</th>
                        <th class="text-right py-2 text-gray-600 dark:text-gray-300">Pagado</th>
                        <th class="text-right py-2 text-gray-600 dark:text-gray-300">Pendiente</th>
                        <th class="text-center py-2 text-gray-600 dark:text-gray-300">Cumplimiento</th>
                        <th class="text-center py-2 text-gray-600 dark:text-gray-300">Acciones</th>
                    </tr>
                    </thead>
                    <tbody id="accountingPlayersTable">
                    <tr>
                        <td colspan="6" class="text-center py-8 text-gray-500 dark:text-gray-400">
                        Cargando datos...
                        </td>
                    </tr>
                    </tbody>
                </table>
                </div>
            </div>
            
            <!-- ========================================
                BOTONES DE ACCI√ìN
            ========================================= -->
            <div class="grid md:grid-cols-3 gap-4">
                
                <button onclick="generateFullReport()" class="bg-teal-600 hover:bg-teal-700 text-white py-3 rounded-lg flex items-center justify-center gap-2 transition-colors">
                <i data-lucide="file-text" class="w-5 h-5"></i>
                Reporte Completo PDF
                </button>
                
                <button onclick="exportCSV()" class="bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg flex items-center justify-center gap-2 transition-colors">
                <i data-lucide="download" class="w-5 h-5"></i>
                Exportar Ingresos CSV
                </button>
                
                <button onclick="exportExpensesCSV()" class="bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg flex items-center justify-center gap-2 transition-colors">
                <i data-lucide="download" class="w-5 h-5"></i>
                Exportar Egresos CSV
                </button>
                
            </div>
            
            </div>
                    
        </main>

       <!-- Bottom Navigation -->
        <nav class="bg-white dark:bg-gray-800 shadow-lg fixed bottom-0 left-0 right-0 z-40 border-t border-gray-200 dark:border-gray-700">
            <div class="flex justify-around items-center py-2">
                <button onclick="navigateTo('dashboard')" data-nav="dashboard" class="nav-item flex flex-col items-center gap-1 px-3 py-2 rounded-lg transition-all">
                    <i data-lucide="home" class="w-5 h-5"></i>
                    <span class="text-xs">Inicio</span>
                </button>
                <button onclick="navigateTo('players')" data-nav="players" class="nav-item flex flex-col items-center gap-1 px-3 py-2 rounded-lg transition-all">
                    <i data-lucide="users" class="w-5 h-5"></i>
                    <span class="text-xs">Jugadores</span>
                </button>
                <button onclick="navigateTo('payments')" data-nav="payments" class="nav-item flex flex-col items-center gap-1 px-3 py-2 rounded-lg transition-all">
                    <i data-lucide="dollar-sign" class="w-5 h-5"></i>
                    <span class="text-xs">Pagos</span>
                </button>
                <button onclick="navigateTo('calendar')" data-nav="calendar" class="nav-item flex flex-col items-center gap-1 px-3 py-2 rounded-lg transition-all">
                    <i data-lucide="calendar" class="w-5 h-5"></i>
                    <span class="text-xs">Calendario</span>
                </button>
                <button onclick="navigateTo('settings')" data-nav="settings" class="nav-item flex flex-col items-center gap-1 px-3 py-2 rounded-lg transition-all">
                    <i data-lucide="settings" class="w-5 h-5"></i>
                    <span class="text-xs">M√°s</span>
                </button>
            </div>
        </nav>
    </div>

    <!-- ========================================
         MODALES
    ========================================= -->

    <!-- Modal Agregar/Editar Jugador -->
   <div id="playerModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in">
        <div class="sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between z-10">
            <h3 id="playerModalTitle" class="font-bold text-xl text-gray-800 dark:text-white">Agregar Jugador</h3>
            <button onclick="closePlayerModal()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                <i data-lucide="x" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
            </button>
        </div>
        <form id="playerForm" class="p-4 space-y-4">
            <input type="hidden" id="playerId">
            
            <div class="text-center">
                <input type="file" id="playerAvatar" accept="image/*" class="hidden">
                <img id="playerAvatarPreview" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23e5e7eb'/%3E%3Ctext x='50' y='50' text-anchor='middle' dy='.3em' font-size='40' fill='%239ca3af'%3Eüë§%3C/text%3E%3C/svg%3E" alt="Avatar" class="w-24 h-24 rounded-full mx-auto object-cover border-4 border-teal-500 cursor-pointer" onclick="document.getElementById('playerAvatar').click()">
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">Click para cambiar foto (m√°x 2MB)</p>
            </div>

            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nombre Completo *</label>
                    <input type="text" id="playerName" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fecha de Nacimiento *</label>
                    <input type="date" id="playerBirthDate" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
            </div>

                    <!-- üÜï DOCUMENTO DE IDENTIDAD -->
        <div class="grid md:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Documento</label>
                <select id="playerDocumentType" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                    <option value="">Seleccionar...</option>
                    <option value="TI">TI - Tarjeta de Identidad</option>
                    <option value="RC">RC - Registro Civil</option>
                    <option value="CC">CC - C√©dula de Ciudadan√≠a</option>
                    <option value="CE">CE - C√©dula de Extranjer√≠a</option>
                    <option value="PA">PA - Pasaporte</option>
                    <option value="NUIP">NUIP</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">N√∫mero de Documento</label>
                <input type="text" id="playerDocumentNumber" placeholder="Ej: 1234567890" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
            </div>
        </div>

            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Categor√≠a *</label>
                    <select id="playerCategory" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                        <option value="">Seleccionar...</option>
                        <option value="Categor√≠a 2010">Categor√≠a 2010</option>
                        <option value="Categor√≠a 2011">Categor√≠a 2011</option>
                        <option value="Categor√≠a 2012">Categor√≠a 2012</option>
                        <option value="Categor√≠a 2013">Categor√≠a 2013</option>
                        <option value="Categor√≠a 2014">Categor√≠a 2014</option>
                        <option value="Categor√≠a 2015">Categor√≠a 2015</option>
                        <option value="Categor√≠a 2016">Categor√≠a 2016</option>
                        <option value="Categor√≠a 2017">Categor√≠a 2017</option>
                        <option value="Categor√≠a 2018">Categor√≠a 2018</option>
                        <option value="Categor√≠a 2019">Categor√≠a 2019</option>
                        <option value="Categor√≠a 2020">Categor√≠a 2020</option>
                        <option value="Categor√≠a 2021">Categor√≠a 2021</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Posici√≥n</label>
                    <select id="playerPosition" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                        <option value="">Seleccionar...</option>
                        <option value="Portero">Portero</option>
                        <option value="Defensa Central">Defensa Central</option>
                        <option value="Lateral Derecho">Lateral Derecho</option>
                        <option value="Lateral Izquierdo">Lateral Izquierdo</option>
                        <option value="Medio Centro">Medio Centro</option>
                        <option value="Medio Defensivo">Medio Defensivo</option>
                        <option value="Medio Ofensivo">Medio Ofensivo</option>
                        <option value="Extremo Derecho">Extremo Derecho</option>
                        <option value="Extremo Izquierdo">Extremo Izquierdo</option>
                        <option value="Delantero Centro">Delantero Centro</option>
                    </select>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">N√∫mero de Camiseta</label>
                    <input type="number" id="playerJerseyNumber" min="1" max="99" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Talla Uniforme</label>
                    <select id="playerUniformSize" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                        <option value="">Seleccionar...</option>
                        <option value="4">4</option>
                        <option value="6">6</option>
                        <option value="8">8</option>
                        <option value="10">10</option>
                        <option value="12">12</option>
                        <option value="14">14</option>
                        <option value="XS">XS</option>
                        <option value="S">S</option>
                        <option value="M">M</option>
                        <option value="L">L</option>
                        <option value="XL">XL</option>
                    </select>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                    <input type="email" id="playerEmail" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tel√©fono Acudiente *</label>
                    <input type="tel" id="playerPhone" required placeholder="+57 300 1234567" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Contacto de Emergencia</label>
                <input type="tel" id="playerEmergencyContact" placeholder="+57 300 1234567" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Direcci√≥n</label>
                <input type="text" id="playerAddress" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
            </div>

            <div class="border-t border-gray-300 dark:border-gray-600 pt-4">
                <h4 class="font-medium text-gray-800 dark:text-white mb-3 flex items-center gap-2">
                    <i data-lucide="heart-pulse" class="w-5 h-5 text-red-600"></i>
                    Informaci√≥n M√©dica
                </h4>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Sangre</label>
                        <select id="playerBloodType" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                            <option value="">Seleccionar...</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Alergias</label>
                        <input type="text" id="playerAllergies" placeholder="Ninguna" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                    </div>
                </div>
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Medicamentos</label>
                    <input type="text" id="playerMedications" placeholder="Ninguno" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Condiciones Especiales</label>
                    <textarea id="playerConditions" rows="2" placeholder="Ninguna" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500"></textarea>
                </div>
            </div>

            <div class="flex gap-2 pt-4 sticky bottom-0 bg-white dark:bg-gray-800 pb-2">
                <button type="button" onclick="closePlayerModal()" class="flex-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    Cancelar
                </button>
                <button type="submit" class="flex-1 bg-teal-600 hover:bg-teal-700 text-white py-2 rounded-lg transition-colors">
                    Guardar
                </button>
            </div>
        </form>
    </div>
   </div>
    <!-- Modal Detalles Jugador -->
    <div id="playerDetailsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in">
            <div class="sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between">
                <h3 class="font-bold text-xl text-gray-800 dark:text-white">Detalles del Jugador</h3>
                <button onclick="closePlayerDetailsModal()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                    <i data-lucide="x" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
                </button>
            </div>
            <div id="playerDetailsContent" class="p-4"></div>
        </div>
    </div>

    <!-- ========================================
     MODAL: SELECTOR DE TIPO DE PAGO
     ‚ö†Ô∏è AGREGAR ANTES DEL MODAL DE PAGO EXISTENTE
========================================= -->
<div id="paymentTypeSelectorModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full animate-scale-in">
        <div class="border-b border-gray-200 dark:border-gray-700 p-6 text-center">
            <div class="w-16 h-16 bg-gradient-to-r from-teal-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                <i data-lucide="dollar-sign" class="w-8 h-8 text-white"></i>
            </div>
            <h3 class="font-bold text-2xl text-gray-800 dark:text-white mb-2">Registrar Pago</h3>
            <p class="text-sm text-gray-500 dark:text-gray-400">Selecciona el tipo de pago que deseas registrar</p>
        </div>
        
        <div class="p-6 space-y-3">
            <!-- Opci√≥n: Ingreso -->
            <button onclick="selectPaymentType('ingreso')" class="w-full bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white p-4 rounded-xl flex items-center gap-4 transition-all transform hover:scale-105 shadow-lg">
                <div class="bg-white bg-opacity-20 p-3 rounded-lg">
                    <i data-lucide="trending-up" class="w-8 h-8"></i>
                </div>
                <div class="flex-1 text-left">
                    <h4 class="font-bold text-lg">Ingreso</h4>
                    <p class="text-sm opacity-90">Mensualidades, uniformes, torneos</p>
                </div>
                <i data-lucide="chevron-right" class="w-6 h-6"></i>
            </button>
            
<!-- Opci√≥n: Egreso -->
            <button onclick="selectPaymentType('egreso')" class="w-full bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white p-4 rounded-xl flex items-center gap-4 transition-all transform hover:scale-105 shadow-lg">
                <div class="bg-white bg-opacity-20 p-3 rounded-lg">
                    <i data-lucide="trending-down" class="w-8 h-8"></i>
                </div>
                <div class="flex-1 text-left">
                    <h4 class="font-bold text-lg">Egreso</h4>
                    <p class="text-sm opacity-90">Salarios, servicios, materiales</p>
                </div>
                <i data-lucide="chevron-right" class="w-6 h-6"></i>
            </button>
            
            <!-- Opci√≥n: Otro Ingreso -->
            <button onclick="selectPaymentType('otroIngreso')" class="w-full bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white p-4 rounded-xl flex items-center gap-4 transition-all transform hover:scale-105 shadow-lg">
                <div class="bg-white bg-opacity-20 p-3 rounded-lg">
                    <i data-lucide="wallet" class="w-8 h-8"></i>
                </div>
                <div class="flex-1 text-left">
                    <h4 class="font-bold text-lg">Otro Ingreso</h4>
                    <p class="text-sm opacity-90">Rifas, productos, torneos, etc.</p>
                </div>
                <i data-lucide="chevron-right" class="w-6 h-6"></i>
            </button>
        </div>
        
        <div class="p-6 pt-0">
            <button onclick="closePaymentTypeSelectorModal()" class="w-full border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                Cancelar
            </button>
        </div>
    </div>
</div>


<!-- ========================================
     MODAL REGISTRAR PAGO - CON BUSCADOR DE JUGADORES
     ======================================== -->

<div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden p-4">
  <div class="modal-content max-w-2xl w-full bg-white dark:bg-gray-800 rounded-2xl p-6 max-h-[90vh] overflow-y-auto">
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Registrar Pago</h2>
      <button onclick="closePaymentModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
        <i data-lucide="x" class="w-6 h-6"></i>
      </button>
    </div>

    <form id="paymentForm">
      <input type="hidden" id="paymentId">

      <!-- üîç BUSCADOR DE JUGADORES -->
      <div class="mb-6">
        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
          Jugador *
        </label>
        
        <!-- Jugador Seleccionado -->
        <div id="selectedPlayerDisplay" class="hidden mb-3 p-3 bg-teal-50 dark:bg-teal-900 border-2 border-teal-500 rounded-lg flex items-center justify-between">
          <div class="flex items-center gap-2">
            <i data-lucide="user-check" class="w-5 h-5 text-teal-600"></i>
            <span id="selectedPlayerName" class="font-semibold text-gray-800 dark:text-white"></span>
          </div>
          <button 
            type="button" 
            onclick="clearPlayerSelection()" 
            class="text-red-600 hover:text-red-700 dark:text-red-400"
            title="Cambiar jugador"
          >
            <i data-lucide="x-circle" class="w-5 h-5"></i>
          </button>
        </div>
        
        <!-- Input de B√∫squeda -->
        <div class="relative">
          <i data-lucide="search" class="absolute left-3 top-3 w-5 h-5 text-gray-400"></i>
          <input
            type="text"
            id="playerSearchInput"
            placeholder="Buscar por nombre o categor√≠a..."
            oninput="searchPlayers()"
            class="w-full px-4 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
            autocomplete="off"
          >
        </div>
        
        <!-- Lista de Resultados -->
        <div 
          id="playerSearchResults" 
          class="mt-2 max-h-64 overflow-y-auto border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"
        >
          <!-- Los jugadores se cargar√°n aqu√≠ din√°micamente -->
        </div>
      </div>

      <!-- Tipo de Pago -->
      <div class="mb-4">
        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
          Tipo de Pago *
        </label>
        <select id="paymentType" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white" required>
          <option value="Mensualidad">Mensualidad</option>
          <option value="Uniforme">Uniforme</option>
          <option value="Torneo">Torneo</option>
          <option value="Equipamiento">Equipamiento</option>
          <option value="Otro">Otro</option>
        </select>
      </div>

      <!-- Concepto -->
      <div class="mb-4">
        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
          Concepto *
        </label>
        <input type="text" id="paymentConcept" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white" required>
      </div>

      <!-- Monto y Fecha de Vencimiento -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
            Monto *
          </label>
          <input type="number" id="paymentAmount" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white" required min="0" step="0.01">
        </div>
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
            Fecha de Vencimiento *
          </label>
          <input type="date" id="paymentDueDate" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white" required>
        </div>
      </div>

      <!-- Estado -->
      <div class="mb-4">
        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
          Estado *
        </label>
        <select id="paymentStatus" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white" required>
          <option value="Pendiente">Pendiente</option>
          <option value="Pagado">Pagado</option>
        </select>
      </div>

      <!-- Fecha de Pago (Solo si est√° pagado) -->
      <div id="paidDateContainer" class="mb-4 hidden">
        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
          Fecha de Pago *
        </label>
        <input type="date" id="paymentPaidDate" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
      </div>

      <!-- M√©todo de Pago (Solo si est√° pagado) -->
      <div id="paymentMethodContainer" class="mb-4 hidden">
        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
          M√©todo de Pago *
        </label>
        <select id="paymentMethod" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
          <option value="Efectivo">Efectivo</option>
          <option value="Transferencia">Transferencia</option>
          <option value="Tarjeta">Tarjeta</option>
        </select>
      </div>

      <!-- Botones -->
      <div class="flex gap-3">
        <button 
          type="button" 
          onclick="closePaymentModal()" 
          class="flex-1 px-4 py-3 bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-800 dark:text-white rounded-lg font-medium transition-colors"
        >
          Cancelar
        </button>
        <button 
          type="submit" 
          class="flex-1 px-4 py-3 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-medium transition-colors"
        >
          Guardar
        </button>
      </div>
    </form>
  </div>
</div>

    <!-- Modal Agregar/Editar Evento -->
    <div id="eventModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-lg w-full animate-scale-in">
            <div class="border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between">
                <h3 class="font-bold text-xl text-gray-800 dark:text-white">Agregar Evento</h3>
                <button onclick="closeEventModal()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                    <i data-lucide="x" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
                </button>
            </div>
            <form id="eventForm" class="p-4 space-y-4">
                <input type="hidden" id="eventId">
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Evento *</label>
                    <select id="eventType" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                        <option value="">Seleccionar...</option>
                        <option value="Partido">Partido</option>
                        <option value="Entrenamiento">Entrenamiento</option>
                        <option value="Torneo">Torneo</option>
                        <option value="Otro">Otro Evento</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">T√≠tulo *</label>
                    <input type="text" id="eventTitle" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Descripci√≥n</label>
                    <textarea id="eventDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white"></textarea>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fecha *</label>
                        <input type="date" id="eventDate" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hora *</label>
                        <input type="time" id="eventTime" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ubicaci√≥n</label>
                    <input type="text" id="eventLocation" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                </div>

                <div class="flex gap-2 pt-4">
                    <button type="button" onclick="closeEventModal()" class="flex-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-2 rounded-lg">
                        Cancelar
                    </button>
                    <button type="submit" class="flex-1 bg-teal-600 hover:bg-teal-700 text-white py-2 rounded-lg">
                        Guardar
                    </button>
                </div>
            </form>
        </div>
    </div>
       
    <!-- Modal Agregar/Editar Egreso -->
<div id="expenseModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in">
        <div class="sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between z-10">
            <h3 class="font-bold text-xl text-gray-800 dark:text-white">Registrar Egreso</h3>
            <button onclick="closeExpenseModal()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                <i data-lucide="x" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
            </button>
        </div>
        
        <form id="expenseForm" class="p-4 space-y-4">
            <input type="hidden" id="expenseId">
            
            <!-- Tipo de Beneficiario -->
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Beneficiario *</label>
                <div class="flex gap-4">
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="radio" name="beneficiaryType" value="internal" id="beneficiaryTypeInternal" checked onchange="showBeneficiaryType('internal')" class="w-4 h-4 text-teal-600">
                        <span class="text-sm text-gray-700 dark:text-gray-300">Usuario/Staff</span>
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="radio" name="beneficiaryType" value="external" id="beneficiaryTypeExternal" onchange="showBeneficiaryType('external')" class="w-4 h-4 text-teal-600">
                        <span class="text-sm text-gray-700 dark:text-gray-300">Externo</span>
                    </label>
                </div>
            </div>
            
            <!-- Beneficiario Interno -->
            <div id="internalBeneficiarySection">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Seleccionar Usuario/Staff *</label>
                <select id="expenseBeneficiaryInternal" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                    <option value="">Seleccionar...</option>
                </select>
            </div>
            
            <!-- Beneficiario Externo -->
            <div id="externalBeneficiarySection" class="hidden space-y-3">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nombre Completo *</label>
                    <input type="text" id="expenseBeneficiaryName" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tel√©fono</label>
                        <input type="tel" id="expenseBeneficiaryPhone" placeholder="+57 300 1234567" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Documento</label>
                        <input type="text" id="expenseBeneficiaryDocument" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                    <input type="email" id="expenseBeneficiaryEmail" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Direcci√≥n</label>
                    <input type="text" id="expenseBeneficiaryAddress" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
            </div>
            
            <!-- Datos del Egreso -->
            <div class="border-t border-gray-300 dark:border-gray-600 pt-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Categor√≠a *</label>
                        <select id="expenseCategory" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                            <option value="">Seleccionar...</option>
                            <option value="Salarios">Salarios</option>
                            <option value="Servicios">Servicios</option>
                            <option value="Materiales">Materiales</option>
                            <option value="Mantenimiento">Mantenimiento</option>
                            <option value="Impuestos">Impuestos</option>
                            <option value="Otro">Otro</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Monto *</label>
                        <input type="number" id="expenseAmount" required min="0" step="0.01" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                    </div>
                </div>
                
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Concepto *</label>
                    <input type="text" id="expenseConcept" required placeholder="Ej: Pago de salario enero" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                </div>
                
                <div class="grid grid-cols-2 gap-4 mt-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fecha *</label>
                        <input type="date" id="expenseDate" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">M√©todo de Pago *</label>
                        <select id="expenseMethod" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
                            <option value="">Seleccionar...</option>
                            <option value="Efectivo">Efectivo</option>
                            <option value="Transferencia">Transferencia</option>
                            <option value="Tarjeta">Tarjeta</option>
                            <option value="Nequi">Nequi</option>
                            <option value="Daviplata">Daviplata</option>
                        </select>
                    </div>
                </div>
                
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notas</label>
                    <textarea id="expenseNotes" rows="3" placeholder="Informaci√≥n adicional..." class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500"></textarea>
                </div>
            </div>
            
            <!-- Botones -->
            <div class="flex gap-2 pt-4 sticky bottom-0 bg-white dark:bg-gray-800 pb-2">
                <button type="button" onclick="closeExpenseModal()" class="flex-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    Cancelar
                </button>
                <button type="submit" class="flex-1 bg-teal-600 hover:bg-teal-700 text-white py-2 rounded-lg transition-colors">
                    Guardar Egreso
                </button>
            </div>
        </form>
    </div>
</div>

     <!-- Modal Agregar Usuario de Escuela -->
<div id="addSchoolUserModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
  <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto animate-scale-in">
    <div class="sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between z-10">
      <h3 class="font-bold text-xl text-gray-800 dark:text-white">Agregar Usuario</h3>
      <button onclick="closeAddSchoolUserModal()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
        <i data-lucide="x" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
      </button>
    </div>
    
    <form id="addSchoolUserForm" class="p-4 space-y-4">
      <div class="text-center">
        <input type="file" id="schoolUserAvatar" accept="image/*" class="hidden">
        <img id="schoolUserAvatarPreview" src="" alt="Avatar" class="w-24 h-24 rounded-full mx-auto object-cover border-4 border-teal-500 cursor-pointer" onclick="document.getElementById('schoolUserAvatar').click()">
        <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">Click para cambiar foto (m√°x 2MB)</p>
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nombre Completo *</label>
        <input type="text" id="schoolUserName" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email *</label>
        <input type="email" id="schoolUserEmail" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tel√©fono</label>
        <input type="tel" id="schoolUserPhone" placeholder="+57 300 1234567" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fecha de Nacimiento</label>
        <input type="date" id="schoolUserBirthDate" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Contrase√±a *</label>
        <div class="relative">
          <input type="password" id="schoolUserPassword" required minlength="6" class="w-full px-4 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
          <button type="button" onclick="togglePasswordVisibility('schoolUserPassword')" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
            <i data-lucide="eye" class="w-5 h-5"></i>
          </button>
        </div>
        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">M√≠nimo 6 caracteres</p>
      </div>
      
      <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3">
        <p class="text-xs text-blue-800 dark:text-blue-200">
          ‚ÑπÔ∏è Este usuario tendr√° acceso completo a toda la informaci√≥n de la escuela, igual que t√∫.
        </p>
      </div>
      
      <div class="flex gap-2 pt-4 sticky bottom-0 bg-white dark:bg-gray-800 pb-2">
        <button type="button" onclick="closeAddSchoolUserModal()" class="flex-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
          Cancelar
        </button>
        <button type="submit" class="flex-1 bg-teal-600 hover:bg-teal-700 text-white py-2 rounded-lg transition-colors">
          Guardar Usuario
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Progreso de Factura -->
<div id="invoiceProgressModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-sm w-full text-center animate-scale-in">
        <div class="w-16 h-16 border-4 border-teal-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
        <h3 class="font-bold text-lg text-gray-800 dark:text-white mb-2">Generando Factura</h3>
        <p class="text-sm text-gray-600 dark:text-gray-400" id="invoiceProgressText">Preparando documento PDF...</p>
        <p class="text-xs text-gray-500 dark:text-gray-500 mt-2" id="invoiceNumberText"></p>
    </div>
</div>

<!-- Modal WhatsApp Manual -->
<div id="manualWhatsAppModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-md w-full animate-scale-in">
        <div class="flex items-center justify-between mb-4">
            <h3 class="font-bold text-xl text-gray-800 dark:text-white">Enviar por WhatsApp</h3>
            <button onclick="closeManualWhatsAppModal()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                <i data-lucide="x" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
            </button>
        </div>
        
        <input type="hidden" id="manualWhatsAppItemId">
        <input type="hidden" id="manualWhatsAppItemType">
        
        <div class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3 mb-4">
            <p class="text-sm text-yellow-800 dark:text-yellow-200">
                ‚ö†Ô∏è Este contacto no tiene tel√©fono registrado. Ingresa el n√∫mero de WhatsApp manualmente.
            </p>
        </div>
        
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">N√∫mero de WhatsApp *</label>
            <input 
                type="tel" 
                id="manualWhatsAppPhone" 
                placeholder="+57 300 1234567"
                class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-teal-500">
            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Incluye el c√≥digo de pa√≠s (ej: +57 para Colombia)</p>
        </div>
        
        <div class="flex gap-2">
            <button onclick="closeManualWhatsAppModal()" class="flex-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                Cancelar
            </button>
            <button onclick="sendManualWhatsApp()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg flex items-center justify-center gap-2 transition-colors">
                <i data-lucide="send" class="w-4 h-4"></i>
                Enviar
            </button>
        </div>
    </div>
</div>

<!-- Modal Otros Ingresos -->
<div id="thirdPartyIncomeModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto animate-scale-in">
        <div class="flex items-center justify-between mb-4">
            <h3 class="font-bold text-xl text-gray-800 dark:text-white">üí∞ Registrar Otro Ingreso</h3>
            <button onclick="closeThirdPartyIncomeModal()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                <i data-lucide="x" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
            </button>
        </div>
        
        <form id="thirdPartyIncomeForm" onsubmit="event.preventDefault(); saveThirdPartyIncomeFromForm();">
            <input type="hidden" id="thirdPartyIncomeId">
            
            <!-- Tipo de Aportante -->
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Aportante *</label>
                <div class="flex gap-4">
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="radio" name="contributorType" id="contributorTypePerson" value="person" checked class="text-purple-600">
                        <span class="text-gray-700 dark:text-gray-300">üë§ Persona</span>
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="radio" name="contributorType" id="contributorTypeCompany" value="company" class="text-purple-600">
                        <span class="text-gray-700 dark:text-gray-300">üè¢ Empresa</span>
                    </label>
                </div>
            </div>
            
            <!-- Datos del Aportante -->
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-4">
                <h4 class="font-medium text-gray-800 dark:text-white mb-3">Datos del Aportante</h4>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nombre *</label>
                        <input type="text" id="thirdPartyContributorName" list="contributorsList" onchange="autoFillContributor()" required
                            class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white" placeholder="Nombre del aportante">
                        <datalist id="contributorsList"></datalist>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tel√©fono</label>
                            <input type="tel" id="thirdPartyContributorPhone" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white" placeholder="+57 300...">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Documento</label>
                            <input type="text" id="thirdPartyContributorDocument" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white" placeholder="Opcional">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                        <input type="email" id="thirdPartyContributorEmail" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white" placeholder="correo@ejemplo.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Direcci√≥n</label>
                        <input type="text" id="thirdPartyContributorAddress" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white" placeholder="Opcional">
                    </div>
                </div>
            </div>
            
            <!-- Datos del Ingreso -->
            <div class="bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 mb-4">
                <h4 class="font-medium text-gray-800 dark:text-white mb-3">Datos del Ingreso</h4>
                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Categor√≠a *</label>
                            <select id="thirdPartyIncomeCategory" onchange="autoFillThirdPartyConcept()" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white">
                                <option value="">Seleccionar...</option>
                                <option value="Mensualidades">üìÖ Mensualidades</option>
                                <option value="Uniformes">üëï Uniformes</option>
                                <option value="Rifas">üéüÔ∏è Rifas</option>
                                <option value="Productos">üì¶ Productos</option>
                                <option value="Torneo">üèÜ Torneo</option>
                                <option value="Integraci√≥n">üéâ Integraci√≥n</option>
                                <option value="Festivales">üéä Festivales</option>
                                <option value="Otros">üíµ Otros</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Monto *</label>
                            <input type="number" id="thirdPartyIncomeAmount" required min="0" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white" placeholder="$ 0">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Concepto *</label>
                        <input type="text" id="thirdPartyIncomeConcept" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white" placeholder="Descripci√≥n del ingreso">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fecha *</label>
                            <input type="date" id="thirdPartyIncomeDate" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">M√©todo *</label>
                            <select id="thirdPartyIncomeMethod" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white">
                                <option value="">Seleccionar...</option>
                                <option value="Efectivo">üíµ Efectivo</option>
                                <option value="Transferencia">üè¶ Transferencia</option>
                                <option value="Nequi">üì± Nequi</option>
                                <option value="Daviplata">üì± Daviplata</option>
                                <option value="Tarjeta">üí≥ Tarjeta</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notas</label>
                        <textarea id="thirdPartyIncomeNotes" rows="2" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white" placeholder="Notas adicionales (opcional)"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="flex gap-2">
                <button type="button" onclick="closeThirdPartyIncomeModal()" class="flex-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                    Cancelar
                </button>
                <button type="submit" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg flex items-center justify-center gap-2">
                    <i data-lucide="save" class="w-5 h-5"></i>
                    Guardar
                </button>
            </div>
        </form>
    </div>
</div>

    <!-- Toast Notifications -->
    <div id="toast" class="hidden fixed bottom-24 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-slide-up"></div>
     
<!-- ========================================== -->
    <!-- SCRIPTS EN ORDEN CORRECTO                 -->
    <!-- ========================================== -->
    
    <!-- 1Ô∏è‚É£ CONFIGURACI√ìN Y UTILIDADES BASE -->
    <script src="js/firebase-config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/phone-utils.js"></script>
    <script src="js/theme.js"></script>
    
    <!-- 2Ô∏è‚É£ STORAGE (BASE DE DATOS - DEBE IR PRIMERO) -->
    <script src="js/storage.js"></script>
    
    <!-- 3Ô∏è‚É£ SINCRONIZACI√ìN FIREBASE (depende de storage) -->
    <script src="js/firebase-sync.js"></script>
    
    <!-- 4Ô∏è‚É£ AUTENTICACI√ìN (depende de storage y firebase) -->
    <script src="js/auth.js"></script>
    <script src="js/license-system.js"></script>
    
    <!-- 5Ô∏è‚É£ M√ìDULOS PRINCIPALES (dependen de storage) -->
    <script src="js/players.js"></script>
    <script src="js/payments.js"></script>
    <script src="js/expenses.js"></script>
    <script src="js/third-party-income.js"></script>
    
    <!-- 6Ô∏è‚É£ M√ìDULOS DE COMUNICACI√ìN Y REPORTES -->
    <script src="js/whatsapp.js"></script>
    <script src="js/pdf.js"></script>
    <script src="js/notifications.js"></script>
    
    <!-- 7Ô∏è‚É£ M√ìDULOS DE CALENDARIO Y FECHAS -->
    <script src="js/calendar.js"></script>
    <script src="js/birthdays.js"></script>
    
    <!-- 8Ô∏è‚É£ M√ìDULOS DE AN√ÅLISIS Y CONFIGURACI√ìN -->
    <script src="js/accounting.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/club-settings-protection.js"></script>
    
    <!-- 9Ô∏è‚É£ MODALES (depende de varios m√≥dulos) -->
    <script src="js/modals.js"></script>
    
    <!-- üîü PWA Y CACH√â (dependen de storage y settings) -->
    <script src="js/install.js"></script>
    <script src="js/cache.js"></script>
    <script src="js/pwa-icons.js"></script>
     <script src="js/license-system.js"></script>
    <!-- ‚≠ê APP (SIEMPRE DE √öLTIMO - Inicializa todo) -->
    <script src="js/app.js"></script>
 <script>
  // Inicializar Firebase autom√°ticamente
  if (typeof initFirebase === 'function') {
    initFirebase();
  }
 </script>
    <script>
   // ========================================
   // VERIFICACI√ìN DE SESI√ìN
   // ========================================
   window.addEventListener('DOMContentLoaded', function() {
       const currentUser = getCurrentUser();
       
       if (!currentUser) {
           // No hay sesi√≥n ‚Üí Redirigir a login
           window.location.href = 'login.html';
       } else {
           // Hay sesi√≥n ‚Üí Mostrar dashboard
           document.getElementById('appContainer').classList.remove('hidden');
           if (typeof initApp === 'function') {
               initApp();
           }
       }
   });
   </script>




    <script>
        
        // Inicializar Lucide Icons
        lucide.createIcons();
        
        // Registrar Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('‚úÖ Service Worker registrado', reg))
                .catch(err => console.log('‚ùå Error al registrar SW', err));
        }
    </script>
        </script>

    <!-- Bot√≥n Flotante de Instalaci√≥n -->
    <button id="installButtonFloat" class="hidden fixed bottom-24 right-4 z-50 bg-gradient-to-r from-teal-600 to-blue-600 text-white px-4 py-3 rounded-full shadow-2xl hover:shadow-3xl transition-all transform hover:scale-110 animate-bounce" onclick="installPWA()" title="Instalar MY CLUB">
        <div class="flex items-center gap-2">
            <i data-lucide="download" class="w-5 h-5"></i>
            <span class="font-medium">Instalar</span>
        </div>
    </button>

</body>
</html>

</body>
</html>